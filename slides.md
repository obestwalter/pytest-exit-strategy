![exit strategy](img/exit-strategy.jpg)

---

# Gentle but firm deprecation policy

---

# motivation

* functionality that has better alternatives still kept around without clear plan
* 3.0 is a good release to introduce a clear deprecation policy
* I have been mainly at the receiving end of deprecation and been bitten (requests, flask)

# Presenter Notes

Usual reason for deprecation is not removing functionality, but to replace OldBusted eay of doing things with NewHotness way of things - so you should actially not despair if you see a deprecation warning but rather cherish the new and much easier way to accomplish your tasks.

Emerging design leads to warts that need to be ironed out at some point to keep the code maintainable and accessible for newcomers.

Want to know how to do it right/gentle might be boring, annoying for old hands but for me something where i feel i could be useful.

I would be interested to 'sell' the new policy to users (especially that we're aware of the pain and that we will not flood them with 'clusters of deprecation' (good name for a progressive death metal band)

users relax: pytest 3.0 != python 3.0

---

# Inspiration

* checked pytest issues to do with warnings and depracation
* python itself (overkill)
* plone (still overkill)
* django (seems o.k.)

---

# Howto

* Sort out all pending issues about warnings
* Deprecation warnings generated by pytest are switched on by default in 3.0
* Versioned deprecation and good reporting (python-deprecate, pytest-warnings)
* Silent (PendingDeprecationWarning) -> loud (DeprecationWarning) -> BOOM!
* Removal only in major version changes (=> first chance in 4.0)
* Deprecation warning document the upgrade path

---

# When?

* Publish the plan without any changes in 3.0
* Put into action earliest in 3.1 

---


# Todo

- collect concrete functionality that should be deprecated
- explore tooling (python-deprecate, pytest-warnings, ...)

---

# Related issues

*  re-enable all warnings by default [#1191](https://github.com/pytest-dev/pytest/issues/1191)
*  pytest should integrate with warnings module [#253](https://github.com/pytest-dev/pytest/issues/253) 
*  Recwarn empty [#28](https://github.com/pytest-dev/pytest/issues/28) 
*  xdist does not report warnings [#602](https://github.com/pytest-dev/pytest/issues/602)
*  Inconsistent behaviour of recwarn [#840](https://github.com/pytest-dev/pytest/issues/840)
*  Option to treat warnings as errors [#1173](https://github.com/pytest-dev/pytest/issues/1173)
*  py.test ignores warnings.simplefilter [#1043](https://github.com/pytest-dev/pytest/issues/1043)
*  Test run summary bar is yellow but not clear why, after updating to v2.8.2 [#1179](https://github.com/pytest-dev/pytest/issues/1179)
*  Warnings do not become errors with `--strict` [#1381](https://github.com/pytest-dev/pytest/issues/1381)
*  Indicate non-pytest warnings in the UI [#1262](https://github.com/pytest-dev/pytest/issues/1262)
*  PendingDeprecationWarning triggered when run with -Werror [#1403](https://github.com/pytest-dev/pytest/issues/1403)
*  
